angular.module('app', [
    /* 3-party module */
    'oc.lazyLoad',
    'ui.router',
    'pascalprecht.translate',

    /* core module */
    'app.common',
    'app.layout'
]);

angular.module('app')
    .config(function($stateProvider, $urlRouterProvider) {
        $urlRouterProvider.otherwise('/page1');
        $stateProvider
            .state('page1', {
                url: '/page1',
                controller: 'page1Controller',
                controllerAs: 'page1Ctrl',
                templateUrl: 'app/page1/page1.html',
                resolve: {
                    page1Mdl: ['$ocLazyLoad', function($ocLazyLoad) {
                        return $ocLazyLoad.load({
                            files: ['app-page1']
                        });
                    }]
                }
            })
            .state('page2', {
                url: '/page2',
                controller: 'page2Controller',
                controllerAs: 'page2Ctrl',
                templateUrl: 'app/page2/page2.html',
                resolve: {
                    page2Mdl: ['$ocLazyLoad', function($ocLazyLoad) {
                        return $ocLazyLoad.load({
                            files: ['app-page2']
                        });
                    }]
                }
            })
            .state('page2.demo1', {
                url: '/demo1',
                controller: 'demo1Controller',
                controllerAs: 'demo1Ctrl',
                templateUrl: 'app/page2/demo1/demo1.html',
                resolve: {
                    page2Demo1Mdl: ['$ocLazyLoad', 'page2Mdl', function($ocLazyLoad, page2Mdl) {
                        return $ocLazyLoad.load({
                            files: ['app-page2-demo1']
                        });
                    }]
                }
            })
            .state('page2.demo2', {
                url: '/demo2',
                controller: 'demo2Controller',
                controllerAs: 'demo2Ctrl',
                templateUrl: 'app/page2/demo2/demo2.html',
                resolve: {
                    page2Demo2Mdl: ['$ocLazyLoad', 'page2Mdl', function($ocLazyLoad, page2Mdl) {
                        return $ocLazyLoad.load({
                            files: ['app-page2-demo2']
                        });
                    }]
                }
            })
    });
angular.module('app')
    .constant('appOption', {
        testOpt: 'I am test appOption!'
    });
    
angular.module('app')
    .config(function($translateProvider) {
        //default language
        $translateProvider.preferredLanguage('en');

        //fallback language if entry is not found in current language
        $translateProvider.fallbackLanguage('en');

        //load language entries from files
        $translateProvider.useStaticFilesLoader({
            prefix: 'static/i18n/messages.', //relative path Eg: /languages/
            suffix: '.json' //file extension
        });
    })
    .run(function($rootScope, $state) {
        $rootScope.$on('$stateChangeStart',
            function(event, toState, toParams, fromState, fromParams) {
                //do something ...
            });
    });

angular
    .module('app')
    .factory("appService", function(appOption, utilsService) {
        var i18n = utilsService.i18n;
        var data = {};
        return {
            data: data
        };
    });

angular.module('app')
    .controller('appController', function(appOption, appService, utilsService) {
        var i18n = utilsService.i18n;
        var appCtrl = this;
        appCtrl.data = appService.data;
        appCtrl.fn = {};

        init();

        /*******************************************************************************
         *
         *  Function Definition
         *
         *******************************************************************************/
        function init() {
            console.log('load appController!');
            console.log(appOption);
        }
    });
requirejs.config({
    baseUrl: 'app/',
    urlArgs: '',
    waitSeconds: 0,

    /**
     *  [css loader]
     */
    map: {
        '*': {
            'css': 'plugin/js/require-css/require-css.min'
        }
    },

    /**
     *  [defined path]
     */
    paths: {
        /**
         *  [css path]
         */

        //base plugin
        'font-awesome<css>': 'plugin/css/fontawesome/css/font-awesome.min',

        //app module
        'app<css>': 'app',
        'app-page1<css>': 'page1/page1',
        'app-page2<css>': 'page2/page2',
        'app-page2-demo1<css>': 'page2/demo1/demo1',
        'app-page2-demo2<css>': 'page2/demo2/demo2',

        /**
         *  [js path]
         */

        //base plugin
        'angular': 'plugin/js/angular/angular.min',

        //angular 3-party module
        'ocLazyLoad-require': 'plugin/js/ocLazyLoad/ocLazyLoad.require.min',
        'angular-ui-router': 'plugin/js/angular-ui-router/angular-ui-router.min',
        'angular-translate': 'plugin/js/angular-translate/angular-translate.min',
        'angular-translate-loader-static-files': 'plugin/js/angular-translate-loader-static-files/angular-translate-loader-static-files.min',

        //app module
        'app': 'app.min',
        'app-common': 'common/common.min',
        'app-layout': 'layout/layout.min',

        'app-page1': 'page1/page1.min',
        'app-page2': 'page2/page2.min',
        'app-page2-demo1': 'page2/demo1/demo1.min',
        'app-page2-demo2': 'page2/demo2/demo2.min',

    },

    /**
     *  [defined load dependance]
     */
    shim: {
        //angular 3-party module
        'ocLazyLoad-require': ['angular'],
        'angular-ui-router': ['angular'],
        'angular-translate': ['angular'],
        'angular-translate-loader-static-files': ['angular-translate'],

        //app module
        'app': [
            /* css module */
            'css!font-awesome<css>',
            'css!app<css>',

            /* js 3-party module */
            'ocLazyLoad-require',
            'angular-ui-router',
            'angular-translate',
            'angular-translate-loader-static-files',
            /* js core module */
            'app-common',
            'app-layout'
        ],
        'app-common': ['angular'],
        'app-layout': ['angular'],
        'app-page1': ['css!app-page1<css>'],
        'app-page2': ['css!app-page2<css>'],
        'app-page2-demo1': ['css!app-page2-demo1<css>'],
        'app-page2-demo2': ['css!app-page2-demo2<css>'],
    }
});


/**
 *  [Start the main app logic]
 */
require(['app'], function() {
    angular.bootstrap(document.querySelector("html"), ['app']);
});
